<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="theme-color" content="#000000">
<meta name="apple-mobile-web-app-capable" content="yes">
<title>動画アプリ</title>
<style>
*{box-sizing:border-box;margin:0;padding:0;font-family:sans-serif}
body{background:#000;color:#fff;overflow:hidden;}
#home,#videoWrapper{width:100vw;height:100vh;position:relative;}
.hidden{display:none;}
ul{list-style:none;padding:20px;}
li{padding:10px 0;border-bottom:1px solid rgba(255,255,255,.2);cursor:pointer}

/* Video Wrapper */
#videoWrapper{background:#000;}
#player{position:absolute;top:0;left:0;width:100%;height:100%;z-index:1;pointer-events:none}

/* Central Controls */
.centralUI{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);display:flex;gap:20px;z-index:50;transition:opacity 0.3s;}
.centralUI.hide{opacity:0;pointer-events:none;}
.centralUI button{background:rgba(0,0,0,.5);border:none;color:#fff;font-size:40px;padding:10px 20px;border-radius:50%;cursor:pointer;opacity:0.8}
.centralUI button:hover{opacity:1}

/* Skip Intro */
#skipIntro{position:absolute;right:20px;bottom:80px;background:rgba(0,0,0,.85);padding:10px 16px;border-radius:4px;display:none;z-index:30;text-align:center}
#skipBar{height:3px;background:#e50914;width:0%;margin-top:4px;border-radius:2px}

/* Bottom Controls */
#bottomControls{position:absolute;bottom:0;width:100%;background:rgba(0,0,0,.6);display:flex;align-items:center;gap:10px;padding:8px 12px;z-index:40;transition:opacity 0.3s;}
#bottomControls.hide{opacity:0;pointer-events:none;}
#progress{flex:1}
select{background:#111;color:#fff;border:1px solid #fff;padding:6px}

/* Chapter Panel */
#chapterBtn{position:fixed;top:20px;right:20px;z-index:41}
#chapterPanel{position:fixed;top:0;right:0;width:300px;height:100vh;background:rgba(0,0,0,.7);backdrop-filter:blur(5px);transform:translateX(100%);transition:.3s;overflow-y:auto;padding:20px;z-index:42;}
#chapterPanel.open{transform:translateX(0)}
.groupTitle{margin:20px 0 10px;color:#e50914;font-weight:bold}
#chapterPanel p{margin:6px 0;padding:6px 0;border-bottom:1px solid rgba(255,255,255,.2);cursor:pointer}
</style>
</head>

<body>

<!-- Home Screen -->
<div id="home">
<h2 style="padding:20px;color:#e50914;">動画リスト</h2>
<ul id="videoList">
<li onclick="playVideo('FARzkNhit5Q')">第一回オンライン勉強会ノロウイルスの対応について</li>
<li onclick="playVideo('VIDEO_ID2')">PPE着脱手順解説動画（配信予定）</li>
<li onclick="playVideo('VIDEO_ID3')">未配信</li>
</ul>
</div>

<!-- Video Player -->
<div id="videoWrapper" class="hidden">
<div id="player"></div>

<!-- Central Buttons -->
<div class="centralUI" id="centralUI">
<button id="rewindBtn" onclick="rewind10()">«10</button>
<button id="playBtn" onclick="togglePlay()">▶</button>
<button id="skip10Btn" onclick="forward10()">»10</button>
</div>

<!-- Skip Intro -->
<div id="skipIntro" onclick="skipIntro()">イントロをスキップ
<div id="skipBar"></div></div>

<!-- Bottom Controls -->
<div id="bottomControls">
<span id="currentTime">0:00</span>
<input type="range" id="progress" min="0" max="100" value="0">
<span id="duration">0:00</span>
<select onchange="changeSpeed(this.value)">
<option value="1">1x</option>
<option value="1.25">1.25x</option>
<option value="1.5">1.5x</option>
<option value="2">2x</option>
</select>
</div>

<!-- Chapter Button -->
<button id="chapterBtn" onclick="toggleChapters()">チャプター</button>

<!-- Chapters -->
<div id="chapterPanel">
<div class="groupTitle">本章</div>
<p onclick="goTo(0)">オープニング</p>
<p onclick="goTo(37)">はじめに・導入</p>
<p onclick="goTo(166)">ノロウイルスの基本知識</p>
<p onclick="goTo(312)">ノロウイルス感染予防策</p>
<p onclick="goTo(434)">次亜塩素酸ナトリウム調製</p>

<div class="groupTitle">実践動画</div>
<p onclick="goTo(534)">次亜塩素酸ナトリウム調製（実践動画）</p>
<p onclick="goTo(680)">物品確認編</p>
<p onclick="goTo(781)">吐物回収編</p>

<div class="groupTitle">ポイント確認</div>
<p onclick="goTo(129)">第1章</p>
<p onclick="goTo(270)">第2章</p>
<p onclick="goTo(388)">第3章</p>
<p onclick="goTo(588)">第4章</p>
<p onclick="goTo(938)">第5章</p>
</div>


<script src="https://www.youtube.com/iframe_api"></script>
<script>
let player,lastTapTime=0;
const progress=document.getElementById("progress");
const centralUI=document.getElementById("centralUI");
const bottomControls=document.getElementById("bottomControls");

// 動画再生
function playVideo(videoId){
document.getElementById("home").classList.add("hidden");
document.getElementById("videoWrapper").classList.remove("hidden");
player=new YT.Player('player',{
videoId:videoId,
playerVars:{controls:0,rel:0,modestbranding:1,fs:0,playsinline:1,disablekb:1,iv_load_policy:3},
events:{'onReady':init}
});
}

// 初期化
function init(){setInterval(updateUI,500);showUI();}

// UIフェードアウト制御
let uiTimer;
function showUI(){
centralUI.classList.remove('hide');
bottomControls.classList.remove('hide');
clearTimeout(uiTimer);
uiTimer=setTimeout(()=>{
centralUI.classList.add('hide');
bottomControls.classList.add('hide');
},3000);
}

// UI再表示 タップ/クリックで
document.addEventListener("click",()=>{showUI();});
document.addEventListener("touchend",()=>{showUI();});

// UI更新
function updateUI(){
if(!player.getDuration())return;
let c=player.getCurrentTime();
let d=player.getDuration();
document.getElementById("currentTime").innerText=formatTime(c);
document.getElementById("duration").innerText=formatTime(d);
progress.value=(c/d*100);

// イントロスキップ表示 10~36秒
const skip=document.getElementById("skipIntro");
const bar=document.getElementById("skipBar");
if(c>10 && c<36){skip.style.display="block";bar.style.width=((c-10)/26*100)+"%";}
else{skip.style.display="none";}
}

// シーク
progress.addEventListener("input",()=>{player.seekTo(progress.value/100*player.getDuration(),true);});

// 再生/停止
function togglePlay(){
let state=player.getPlayerState();
if(state===1)player.pauseVideo();
else player.playVideo();
}

// 巻き戻し・進む
function rewind10(){player.seekTo(player.getCurrentTime()-10,true);}
function forward10(){player.seekTo(player.getCurrentTime()+10,true);}
function skipIntro(){player.seekTo(36,true);}

// チャプター操作
function toggleChapters(){document.getElementById("chapterPanel").classList.toggle("open");}
function goTo(t){player.seekTo(t,true);toggleChapters();}

// 再生速度
function changeSpeed(rate){player.setPlaybackRate(parseFloat(rate));}

// タップでダブルタップ左右スキップ、中央再生（PCも対応）
document.addEventListener("touchend",function(e){
let now=new Date().getTime();
let tapLength=now-lastTapTime;
if(tapLength<300&&tapLength>0){
let x=e.changedTouches[0].clientX,w=window.innerWidth;
if(x<w/3){rewind10();}
else if(x>w*2/3){forward10();}
else{togglePlay();}
}
lastTapTime=now;
});

// 横スワイプでチャプター閉じる
let startX=0;
const panel=document.getElementById("chapterPanel");
panel.addEventListener("touchstart", e=>{startX=e.touches[0].clientX;});
panel.addEventListener("touchend", e=>{
let endX=e.changedTouches[0].clientX;
if(endX < startX - 50){panel.classList.remove("open");}
});

// 時間フォーマット
function formatTime(t){let m=Math.floor(t/60);let s=Math.floor(t%60);if(s<10)s="0"+s;return m+":"+s;}
</script>
</body>
</html>
