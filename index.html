<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<title>å‹•ç”»ã‚¢ãƒ—ãƒª</title>

<style>
*{box-sizing:border-box;margin:0;padding:0;font-family:sans-serif;}
body,html{width:100%;height:100%;background:#000;overflow:hidden;color:#fff;}

#loader{
position:fixed;top:0;left:0;width:100%;height:100%;
background:#111;display:flex;align-items:center;justify-content:center;
z-index:100;
}

#nameInputModal{
position:fixed;top:0;left:0;width:100%;height:100%;
background:rgba(0,0,0,0.95);
display:flex;align-items:center;justify-content:center;
flex-direction:column;z-index:101;text-align:center;padding:20px;
}
#nameInputModal input{
padding:12px;font-size:16px;border-radius:8px;border:none;margin:10px;
}
#nameInputModal button{
padding:10px 20px;background:#e50914;color:#fff;border:none;border-radius:8px;
}

#home{width:100%;height:100%;overflow-y:auto;}
#videoList{list-style:none;padding:20px;}
#videoList li{
padding:12px;margin-bottom:10px;background:rgba(255,255,255,0.05);
border-radius:6px;cursor:pointer;
}
.locked{opacity:.4;cursor:default;}
.viewedDate{font-size:12px;color:#aaa;margin-top:4px;}

#videoWrapper{width:100vw;height:100vh;position:relative;display:none;}
#player{position:absolute;width:100%;height:100%;pointer-events:none;}

.centralUI{
position:absolute;top:50%;left:50%;
transform:translate(-50%,-50%);
display:flex;gap:20px;z-index:50;transition:.3s;
}
.centralUI button{
font-size:22px;padding:14px;
background:rgba(180,180,180,.6);
border:none;color:#fff;border-radius:6px;
}

#bottomControls{
position:absolute;bottom:0;width:100%;
background:rgba(0,0,0,.6);
display:flex;align-items:center;
padding:8px;gap:8px;z-index:40;transition:.3s;
}
#progress{flex:1;}
.hideUI{opacity:0;pointer-events:none;}

#resumeInline{
position:absolute;top:60%;left:50%;
transform:translateX(-50%);
display:none;background:rgba(0,0,0,.9);
padding:12px 20px;border-radius:8px;
z-index:60;text-align:center;
}

/* ğŸ”¥ ã‚¤ãƒ³ãƒˆãƒ­ã‚¹ã‚­ãƒƒãƒ— */
#skipIntro{
position:absolute;right:15px;bottom:90px;
background:rgba(0,0,0,.9);
padding:10px 16px;border-radius:6px;
display:none;z-index:999;
overflow:hidden;
cursor:pointer;
}
#skipBar{
position:absolute;bottom:0;left:0;height:4px;
background:#e50914;width:0%;
}
@keyframes grow{
from{width:0%;}
to{width:100%;}
}

#chapterBtn{
position:absolute;top:20px;right:20px;
z-index:70;background:#e50914;
border:none;color:#fff;padding:8px 12px;border-radius:6px;
}
#chapterPanel{
position:absolute;top:0;right:-320px;
width:320px;height:100%;
background:rgba(0,0,0,0.95);
overflow-y:auto;padding:20px;
transition:.3s;z-index:65;
}
#chapterPanel p{margin:8px 0;cursor:pointer;}
.groupTitle{margin-top:15px;font-weight:bold;color:#e50914;}
</style>
</head>
<body>

<div id="loader">ãƒ­ãƒ¼ãƒ‰ä¸­â€¦</div>

<div id="nameInputModal">
<h3>è¦–è´ã™ã‚‹æ–¹ã®åå‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„</h3>
<p style="margin-top:8px;font-size:14px;color:#aaa;">
ï¼ˆæ¬¡å›è¦–è´æ™‚ã€ç¶šãã‹ã‚‰å†ç”Ÿã§ãã¾ã™ã€‚ï¼‰
</p>
<input id="usernameInput">
<button onclick="setUsername()">é–‹å§‹</button>
</div>

<div id="home">
<h2 style="padding:20px;color:#e50914;">å‹•ç”»ãƒªã‚¹ãƒˆ</h2>
<ul id="videoList">
<li onclick="playVideo('FARzkNhit5Q')" id="video_FARzkNhit5Q">
ãƒãƒ­ã‚¦ã‚¤ãƒ«ã‚¹ã®å¯¾å¿œã«ã¤ã„ã¦
<div class="viewedDate"></div>
</li>
<li class="locked">PPEã®ç€è„±æ‰‹é †ï¼ˆé…ä¿¡æ—¥æœªå®šï¼‰</li>
<li class="locked">æœªé…ä¿¡</li>
</ul>
</div>

<div id="videoWrapper">
<div id="player"></div>

<div class="centralUI" id="centralUI">
<button onclick="rewind10()">Â«10</button>
<button id="playBtn" onclick="togglePlay()">â–¶</button>
<button onclick="forward10()">Â»10</button>
</div>

<div id="resumeInline">
<div style="margin-bottom:8px;">å‰å›ã®ç¶šãã‹ã‚‰å†ç”Ÿã—ã¾ã™ã‹ï¼Ÿ</div>
<button onclick="resumeFrom()">ç¶šãã‹ã‚‰è¦‹ã‚‹</button>
<button onclick="startFromBeginning()">åˆã‚ã‹ã‚‰è¦‹ã‚‹</button>
</div>

<div id="skipIntro" onclick="skipIntroClick(event)">
ã‚¤ãƒ³ãƒˆãƒ­ã‚’ã‚¹ã‚­ãƒƒãƒ—
<div id="skipBar"></div>
</div>

<div id="bottomControls">
<span id="currentTime">0:00</span>
<input type="range" id="progress" min="0" max="100" value="0">
<span id="duration">0:00</span>
</div>

<button id="chapterBtn" onclick="toggleChapters()">ãƒãƒ£ãƒ—ã‚¿ãƒ¼</button>

<div id="chapterPanel">
<div class="groupTitle">æœ¬ç« </div>
<p onclick="goTo(0)">ã‚ªãƒ¼ãƒ—ãƒ‹ãƒ³ã‚°</p>
<p onclick="goTo(37)">ã¯ã˜ã‚ã«ãƒ»å°å…¥</p>
<p onclick="goTo(166)">ãƒãƒ­ã‚¦ã‚¤ãƒ«ã‚¹ã®åŸºæœ¬çŸ¥è­˜</p>
<p onclick="goTo(312)">ãƒãƒ­ã‚¦ã‚¤ãƒ«ã‚¹æ„ŸæŸ“äºˆé˜²ç­–</p>
<p onclick="goTo(434)">æ¬¡äºœå¡©ç´ é…¸ãƒŠãƒˆãƒªã‚¦ãƒ èª¿è£½</p>

<div class="groupTitle">å®Ÿè·µå‹•ç”»</div>
<p onclick="goTo(534)">æ¬¡äºœå¡©ç´ é…¸ãƒŠãƒˆãƒªã‚¦ãƒ èª¿è£½ï¼ˆå®Ÿè·µå‹•ç”»ï¼‰</p>
<p onclick="goTo(680)">ç‰©å“ç¢ºèªç·¨</p>
<p onclick="goTo(781)">åç‰©å›åç·¨</p>

<div class="groupTitle">ãƒã‚¤ãƒ³ãƒˆç¢ºèª</div>
<p onclick="goTo(129)">ç¬¬1ç« </p>
<p onclick="goTo(270)">ç¬¬2ç« </p>
<p onclick="goTo(388)">ç¬¬3ç« </p>
<p onclick="goTo(588)">ç¬¬4ç« </p>
<p onclick="goTo(938)">ç¬¬5ç« </p>
</div>
</div>

<script src="https://www.youtube.com/iframe_api"></script>
<script>
let player,username="guest",currentVideoId="";
let resumeTime=0,resumePromptShown=false;
let uiTimer=null,chapterOpen=false;
let introActive=false,uiInterval=null;

function setUsername(){
username=usernameInput.value.trim();
if(!username)return;
nameInputModal.style.display="none";
loader.style.display="none";
updateViewedDates();
}

function playVideo(id){
currentVideoId=id;
resumeTime=parseFloat(localStorage.getItem(username+"_"+id))||0;
resumePromptShown=false;

home.style.display="none";
videoWrapper.style.display="block";

if(uiInterval) clearInterval(uiInterval);

player=new YT.Player('player',{
videoId:id,
playerVars:{controls:0,rel:0,modestbranding:1,fs:0,playsinline:1},
events:{
onReady:()=>{
uiInterval=setInterval(updateUI,500);
showUI();
},
onStateChange:(e)=>{
if(e.data===YT.PlayerState.PLAYING) startUITimer();
}
}
});
}

function togglePlay(){
if(!resumePromptShown && resumeTime>5){
resumeInline.style.display="block";
resumePromptShown=true;
return;
}
let state=player.getPlayerState();
if(state===1){player.pauseVideo();playBtn.innerText="â–¶";}
else{player.playVideo();playBtn.innerText="âšâš";}
showUI();
}

function resumeFrom(){
player.seekTo(resumeTime,true);
player.playVideo();
resumeInline.style.display="none";
}
function startFromBeginning(){
localStorage.removeItem(username+"_"+currentVideoId);
player.seekTo(0,true);
player.playVideo();
resumeInline.style.display="none";
}

function updateUI(){
if(!player.getDuration()) return;

let c=player.getCurrentTime();
let d=player.getDuration();

currentTime.innerText=formatTime(c);
duration.innerText=formatTime(d);
progress.value=c/d*100;

localStorage.setItem(username+"_"+currentVideoId,c);
localStorage.setItem(username+"_date_"+currentVideoId,new Date().toLocaleDateString());

if(c>=10 && c<=15 && !introActive){
introActive=true;
skipIntro.style.display="block";
skipBar.style.animation="none";
void skipBar.offsetWidth;
skipBar.style.animation="grow 5s linear forwards";
setTimeout(()=>{
skipIntro.style.display="none";
introActive=false;
},5000);
}
}

function rewind10(){player.seekTo(player.getCurrentTime()-10,true);showUI();}
function forward10(){player.seekTo(player.getCurrentTime()+10,true);showUI();}
function formatTime(t){let m=Math.floor(t/60),s=Math.floor(t%60);if(s<10)s="0"+s;return m+":"+s;}

progress.addEventListener("input",e=>{
player.seekTo(e.target.value/100*player.getDuration(),true);
showUI();
});

function hideUI(){
centralUI.classList.add("hideUI");
bottomControls.classList.add("hideUI");
}
function showUI(){
centralUI.classList.remove("hideUI");
bottomControls.classList.remove("hideUI");
startUITimer();
}
function startUITimer(){
clearTimeout(uiTimer);
uiTimer=setTimeout(()=>{
if(!chapterOpen && player.getPlayerState()===1){
hideUI();
}
},3000);
}

videoWrapper.addEventListener("click",(e)=>{
if(e.target.id==="skipIntro"||e.target.id==="skipBar") return;
showUI();
});

function skipIntroClick(e){
e.stopPropagation();
player.seekTo(36,true);
skipIntro.style.display="none";
introActive=false;
}

function goTo(sec){
player.seekTo(sec,true);
showUI();
}
function toggleChapters(){
if(chapterPanel.style.right==="0px"){
chapterPanel.style.right="-320px";
chapterOpen=false;
startUITimer();
}else{
chapterPanel.style.right="0px";
chapterOpen=true;
hideUI();
}
}

function updateViewedDates(){
const id="FARzkNhit5Q";
const date=localStorage.getItem(username+"_date_"+id);
if(date){
document.querySelector("#video_"+id+" .viewedDate").innerText="è¦–è´æ¸ˆã¿ï¼š"+date;
}
}
</script>
</body>
</html>
