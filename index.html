<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="theme-color" content="#000000">
<meta name="apple-mobile-web-app-capable" content="yes">
<title>動画アプリ</title>

<style>
*{box-sizing:border-box;margin:0;padding:0;font-family:sans-serif}
body{background:#000;color:#fff;overflow:hidden;}
#home,#videoWrapper{width:100vw;height:100vh;position:relative;}
.hidden{display:none;}
button{background:rgba(255,255,255,.15);color:#fff;border:1px solid #fff;padding:6px 12px;cursor:pointer;margin:2px;}
button:hover{background:rgba(255,255,255,.25);}
ul{list-style:none;padding:20px;}
li{padding:10px 0;border-bottom:1px solid rgba(255,255,255,.2);cursor:pointer;}

/* Video Wrapper */
#videoWrapper{background:#000;}
#player{position:absolute;top:0;left:0;width:100%;height:100%;z-index:1;pointer-events:none}

/* Controls */
#controls{position:absolute;bottom:0;width:100%;background:linear-gradient(to top, rgba(0,0,0,.95), transparent);display:flex;align-items:center;gap:10px;padding:10px;z-index:20;transition:.3s}
#controls.hide{opacity:0}
#progress{flex:1;accent-color:#e50914}

/* Skip Intro */
#skipIntro{position:absolute;bottom:70px;left:50%;transform:translateX(-50%);background:rgba(0,0,0,.85);padding:12px 20px;display:none;z-index:30;text-align:center}
#skipBar{height:3px;background:#e50914;width:0%;margin-top:6px}

/* Chapter Panel */
#chapterBtn{position:fixed;top:20px;right:20px;z-index:40}
#chapterPanel{position:fixed;top:0;right:0;width:300px;height:100vh;background:rgba(0,0,0,.7);backdrop-filter:blur(5px);transform:translateX(100%);transition:.3s;overflow-y:auto;padding:20px;z-index:41;}
#chapterPanel.open{transform:translateX(0)}
.groupTitle{margin:20px 0 10px;color:#e50914;font-weight:bold}
#chapterPanel p{margin:6px 0;padding:6px 0;border-bottom:1px solid rgba(255,255,255,.2);cursor:pointer}

/* Tap Effects */
.tapEffect{position:absolute;top:50%;font-size:40px;font-weight:bold;opacity:0;transition:.3s;z-index:50;user-select:none}
#tapLeft{left:15%;transform:translateY(-50%)}
#tapRight{right:15%;transform:translateY(-50%)}
#tapCenter{left:50%;transform:translate(-50%,-50%)}
</style>
</head>

<body>

<!-- Home Screen -->
<div id="home">
<h2 style="padding:20px;color:#e50914;">動画リスト</h2>
<ul id="videoList">
<li onclick="playVideo('FARzkNhit5Q')">第一回オンライン勉強会ノロウイルスの対応について</li>
<li onclick="playVideo('VIDEO_ID2')">未配信</li>
<li onclick="playVideo('VIDEO_ID3')">未配信</li>
</ul>
</div>

<!-- Video Player -->
<div id="videoWrapper" class="hidden">

<div id="player"></div>

<div id="skipIntro" onclick="skipIntro()">イントロをスキップ
<div id="skipBar"></div></div>

<button id="chapterBtn" onclick="toggleChapters()">チャプター</button>

<div id="controls">
<button onclick="back10()">« 10秒</button>
<button onclick="togglePlay()">▶ / ❚❚</button>
<button onclick="forward10()">10秒 »</button>
<button onclick="changeSpeed()">倍速</button>
<span id="speedLabel">1.0x</span>
<span id="currentTime">0:00</span>
<input type="range" id="progress" value="0" min="0" max="100">
<span id="duration">0:00</span>
</div>

<div id="chapterPanel">
<div class="groupTitle">本章</div>
<p onclick="goTo(0)">オープニング</p>
<p onclick="goTo(37)">はじめに・導入</p>
<p onclick="goTo(166)">ノロウイルスの基本知識</p>
<p onclick="goTo(312)">ノロウイルス感染予防策</p>
<p onclick="goTo(434)">次亜塩素酸ナトリウム調製</p>

<div class="groupTitle">実践動画</div>
<p onclick="goTo(534)">次亜塩素酸ナトリウム調製（実践動画）</p>
<p onclick="goTo(680)">物品確認編</p>
<p onclick="goTo(781)">吐物回収編</p>

<div class="groupTitle">ポイント確認</div>
<p onclick="goTo(129)">第1章</p>
<p onclick="goTo(270)">第2章</p>
<p onclick="goTo(388)">第3章</p>
<p onclick="goTo(588)">第4章</p>
<p onclick="goTo(938)">第5章</p>
</div>

<div id="tapLeft" class="tapEffect">« 10</div>
<div id="tapRight" class="tapEffect">10 »</div>
<div id="tapCenter" class="tapEffect">▶</div>

</div>

<script src="https://www.youtube.com/iframe_api"></script>
<script>
let player;
let hideTimer;
let speeds=[1,1.25,1.5,1.75,2],speedIndex=0;
let lastTapTime=0;
let progress=document.getElementById("progress");

function playVideo(videoId){
document.getElementById("home").classList.add("hidden");
document.getElementById("videoWrapper").classList.remove("hidden");
player=new YT.Player('player',{
videoId:videoId,
playerVars:{controls:0,rel:0,modestbranding:1,fs:0,playsinline:1,disablekb:1,iv_load_policy:3},
events:{'onReady':init}
});
}

function init(){setInterval(updateUI,500);showControls();}

function updateUI(){
if(!player.getDuration()) return;
let c=player.getCurrentTime(),d=player.getDuration();
document.getElementById("currentTime").innerText=formatTime(c);
document.getElementById("duration").innerText=formatTime(d);
progress.value=(c/d)*100;

/* Intro Skip 10~36秒 */
let skip=document.getElementById("skipIntro");
let bar=document.getElementById("skipBar");
if(c>10 && c<36){skip.style.display="block";bar.style.width=((c-10)/26*100)+"%";}
else{skip.style.display="none";}
}

function safeSeek(t){player.seekTo(t,true);setTimeout(()=>{player.playVideo()},200);}
function togglePlay(){let s=player.getPlayerState();if(s===1)player.pauseVideo();else player.playVideo();showControls();}
function back10(){safeSeek(player.getCurrentTime()-10);}
function forward10(){safeSeek(player.getCurrentTime()+10);}
function changeSpeed(){speedIndex++;if(speedIndex>=speeds.length)speedIndex=0;player.setPlaybackRate(speeds[speedIndex]);document.getElementById("speedLabel").innerText=speeds[speedIndex]+"x";}
function skipIntro(){safeSeek(36);}
function goTo(t){safeSeek(t);toggleChapters();}

progress.addEventListener("input",()=>{player.pauseVideo();safeSeek(progress.value/100*player.getDuration());});
function showControls(){document.getElementById("controls").classList.remove("hide");clearTimeout(hideTimer);hideTimer=setTimeout(()=>{document.getElementById("controls").classList.add("hide")},3000);}
document.addEventListener("mousemove",showControls);
document.addEventListener("touchstart",showControls);

function toggleChapters(){document.getElementById("chapterPanel").classList.toggle("open");}

/* ダブルタップスキップ 10/20/30秒 */
document.addEventListener("touchend",function(e){
let now=new Date().getTime();
let tapLength=now-lastTapTime;
if(tapLength<300 && tapLength>0){
let x=e.changedTouches[0].clientX;
let w=window.innerWidth;
if(x<w/3){back10();showTap("tapLeft");}
else if(x>w*2/3){forward10();showTap("tapRight");}
else{togglePlay();showTap("tapCenter");}
}
lastTapTime=now;
});

function showTap(id){let el=document.getElementById(id);el.style.opacity=1;setTimeout(()=>{el.style.opacity=0},400);}
function formatTime(t){let m=Math.floor(t/60);let s=Math.floor(t%60);if(s<10)s="0"+s;return m+":"+s;}
</script>

</body>
</html>
